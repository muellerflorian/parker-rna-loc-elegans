{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"RNA localization in smFISH images \u00b6 This is a collection of analysis tools to study RNA localisation from smFISH images. We provide different analysis workflows (you can select them from the banners). For each we detail the tools and their installations. We use a number of different open-source software packages , when necessasry we detail how to install them. RNA detection is performed with the Matlab package FISH-quant (more details below ). Most postprocessing steps are performed with Python plugins running ImJoy . To use them, you have to install Python with Jupyter and the necessary ImJoy plugins . For more details see the respective sections below. Some annotation tasks are performed with Fiji , which you can download from here .","title":"Overview"},{"location":"#rna-localization-in-smfish-images","text":"This is a collection of analysis tools to study RNA localisation from smFISH images. We provide different analysis workflows (you can select them from the banners). For each we detail the tools and their installations. We use a number of different open-source software packages , when necessasry we detail how to install them. RNA detection is performed with the Matlab package FISH-quant (more details below ). Most postprocessing steps are performed with Python plugins running ImJoy . To use them, you have to install Python with Jupyter and the necessary ImJoy plugins . For more details see the respective sections below. Some annotation tasks are performed with Fiji , which you can download from here .","title":"RNA localization in smFISH images"},{"location":"cell-membrane-dist/","text":"RNA distance distribution to cell cortex \u00b6 Workflow to quantify the distance distribution of RNAs to the cell membrane. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation Test date \u00b6 You can download already processed test data for the Cell membrane enrichment plugin, from Dropbox. The zip archive contains data following the naming conventions of the examples below. Analysis overview \u00b6 For each RNA, we determine the distance to the closest membrane. One thing to keep in mind more pixel close to the membrane than far away, e.g. in the center of the cell. A simple example is a circle. The maximum distance that you can be away from the \u201cmembrane\u201d is the radius of the circle. However, there is only one possibility to be that far away (in the center). Thus, there are many more \u201cclose\u201d positions. Plotting a histogram of the distance to the membrane for all possible positions in the circle, will yield a distribution strongly enriched for small distances. To normalised for this effect, we calculate all possible distance from the membrane for a given cell with a distance transformation . This transformation results in an image, where the pixel values are not fluorescence intensities but distance values. An example is shown below. The blue lines are the cell outlines. The green dots are the detected RNAs. The image is the distance transform. The intensity values are distance to the membrane in pixels. We measure for all RNAs the distance to the membrane and calculate a histogram. We report the Raw RNA distance histogram. Normalised RNA histogram (values add to 1). Normalised distance histogram of all pixels in the cell. Normalised RNA histogram with the pixel histogram. Data organisation \u00b6 We enforce a strict data organisation for this analysis. More information about can be found in the dedicated section below. One folder per sample (\"parental folder\"). Images have to be stored as individual channels. More details for how to convert images are here . Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the parental folder. RNA detection is described in more detail here . Membrane annotations are stored in a dedicated subfolder zstack_segmentation . More information below . As an example, we have one image img1 with 3 channels. The first channels contain analysed smFISH data, the third one contains the cell membrane annotations for two Z slices (slice 3 and 8). . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C2-img1.tif # smFISH image of (channel 2) \u2502 \u251c\u2500 C2-img1__spots.txt # FQ detection results (channel 2) \u2502 \u251c\u2500 C2-img1__settings_MATURE.txt # FQ detection settings (channel 2) \u2502 \u251c\u2500 zstack_segmentation/ \u2502 \u2502 \u251c\u2500 C3-img1_Z3.tif # Image of z-slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z3__RoiSet.zip # Membrane annotation of slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z8.tif # Image of z-slice 2 \u2502 \u2502 \u251c\u2500 C3-img1_Z8__RoiSet.zip # Membrane annotation of slice 2 \u251c\u2500 img2/ . RNA detection \u00b6 Detection of RNAs is performed with FISH-quant and detailed here . Annotations of cell membrane \u00b6 In order to be able to compute the enrichment towards cell membrane or nuclear envelope, these membranes have to be annotated in EACH z-slice that should be considered in the analysis. Below we describe a manual annotation with FIJI, in the future automated segmentation results could be considered as well. Manual with FIJI \u00b6 Annotations have to be performed and stored as described below. For each multi-channel image, the annotations are stored in a dedicated sub-folder called zstack_segmentation . Each annotated z-slice has to be saved as an individual image and the file name has to end with the corresponding z-slice i in the format _Zi . For instance, file name ends with img1_ch3_Z3.tif , where 3 is the actual slice number. In FIJI , open the z-stack and go to menu Image > Stack > Stack to images . You can then save each image with the according file-name. Annotations are stored with the name of the corresponding image, with the additional suffix __RoiSet.zip . For the example above, the added suffix would be img1_ch3_Z3__RoiSet.zip . To perform the actual annotation , follow these steps Open FIJI. Open the ROI manager : Analyze > Tools > ROI manager Open/Select the image that you would like to annotate. Select the annotation tool of choice, e.g. freehand or polygon. Outline first structure of interest. When done, press Add(t) in the ROI manager to add outline to the out line manager. Proceed with all other structures. Enabling Show all , will show all defined regions. Save regions by highlighting all regions in the list and pressing on More >> Save ... If only one region is saved, this will created a file with the extension .roi , if multiple regions will be save this will create a .zip file. As a file-name choose the name of the annotated image, followed by the suffix **__RoiSet.zip** . IMPORTANT : these annotations could be used for training of a neural network. If this is intended, then ALL structures, e.g. nuclei, have to be annotated. Unwanted elements, e.g. nuclei touching the cell border, can be removed in a post-processing step. Analysis with ImJoy \u00b6 The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters. Analysis parameters \u00b6 All options are explained in the Table below. If you change these parameters, the changed values will be saved in the browser and reused the next time you launch ImJoy. Option Type Default Description dZ int 2 Number of z-slices that will be used above and below the currently analyzed slice. Specify this value > 0 if not all z-slices are annotated/ Zmin int 0 Specify at which Z slice analysis should start. Value of 0 means that entire z-stack will be processed. Zmax int 0 As Z min but for maximum Z slice. Channel str 'C3-' Unique identifier for channel containing annotations. Hist [bin] int 20 Bin size for histogram to measure membrane enrichment (in nm). Hist [max] int 100 Maximum value for bins to calculate membrane enrichment. FQ file str FULL path name for FQ file to be analyzed. Launch analysis and monitor progress \u00b6 To analyze a FQ results file, you have to Specify the required parameters in the plugin interface. This includes to copy & paste the FULL name of the FQ results file that should be analyzed. Execute plugin with clicking on the Plugin name CellMembraneDist . The specified file will then be processed and the final distance enrichment histogram displayed in the interface. More plots and result files will be stored as detailed below. Once you start the analysis, ImJoy will show you a progress window with progressbars for the different steps. Once done, it will display the final result in this image. Saved results \u00b6 The analysis script will create a new folder with the same name as the selected results file. To allow to redo the analysis with different settings, the plugin will create for each performed analysis a separate sub folder MembDist_yymmdd-hhmm , where is a time-stamp in the format yymmdd-hhmm . This folder contains several files: _DistanceEnrichmentSummary.png : image containing the pooled analysis of all slices. _HistogramPooled.csv : csv file containing the histograms of the RNA-membrane distance pooled from all z-slices. This can be opened with any Spreadsheet application (Excel, LibreOffice, Numbers, ...) and results from different images can then be pooled together. It contains the following data center : center of the bins histRNA_all : raw RNA distance histogram. histRNA_all_norm : normalized RNA histogram (values add to 1). histpix_all_norm : normalized distance histogram of all pixels in the cell. hist_RNA_all_normPix : normalized RNA histogram with the pixel histogram. Z-i.png : results of slice 'i': DataAll.json : json file containing all analysis results including settings. For the example data above, we would obtain the following folder structure (shows only the relevant part for C1-img1 ): . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C1-img1__spots/ \u2502 \u2502 \u251c\u2500 MembDist_181017-1629/ \u2502 \u2502 \u2502 \u251c\u2500 _HistogramPooled.csv \u2502 \u2502 \u2502 \u251c\u2500 _DistanceEnrichmentSummary.png \u2502 \u2502 \u2502 \u251c\u2500 DataAll.json \u2502 \u2502 \u2502 \u251c\u2500 Z-1.png \u2502 \u2502 \u2502 \u251c\u2500 Z-2.png .","title":"Cell membrane distance"},{"location":"cell-membrane-dist/#rna-distance-distribution-to-cell-cortex","text":"Workflow to quantify the distance distribution of RNAs to the cell membrane. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation","title":"RNA distance distribution to cell cortex"},{"location":"cell-membrane-dist/#test-date","text":"You can download already processed test data for the Cell membrane enrichment plugin, from Dropbox. The zip archive contains data following the naming conventions of the examples below.","title":"Test date"},{"location":"cell-membrane-dist/#analysis-overview","text":"For each RNA, we determine the distance to the closest membrane. One thing to keep in mind more pixel close to the membrane than far away, e.g. in the center of the cell. A simple example is a circle. The maximum distance that you can be away from the \u201cmembrane\u201d is the radius of the circle. However, there is only one possibility to be that far away (in the center). Thus, there are many more \u201cclose\u201d positions. Plotting a histogram of the distance to the membrane for all possible positions in the circle, will yield a distribution strongly enriched for small distances. To normalised for this effect, we calculate all possible distance from the membrane for a given cell with a distance transformation . This transformation results in an image, where the pixel values are not fluorescence intensities but distance values. An example is shown below. The blue lines are the cell outlines. The green dots are the detected RNAs. The image is the distance transform. The intensity values are distance to the membrane in pixels. We measure for all RNAs the distance to the membrane and calculate a histogram. We report the Raw RNA distance histogram. Normalised RNA histogram (values add to 1). Normalised distance histogram of all pixels in the cell. Normalised RNA histogram with the pixel histogram.","title":"Analysis overview"},{"location":"cell-membrane-dist/#data-organisation","text":"We enforce a strict data organisation for this analysis. More information about can be found in the dedicated section below. One folder per sample (\"parental folder\"). Images have to be stored as individual channels. More details for how to convert images are here . Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the parental folder. RNA detection is described in more detail here . Membrane annotations are stored in a dedicated subfolder zstack_segmentation . More information below . As an example, we have one image img1 with 3 channels. The first channels contain analysed smFISH data, the third one contains the cell membrane annotations for two Z slices (slice 3 and 8). . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C2-img1.tif # smFISH image of (channel 2) \u2502 \u251c\u2500 C2-img1__spots.txt # FQ detection results (channel 2) \u2502 \u251c\u2500 C2-img1__settings_MATURE.txt # FQ detection settings (channel 2) \u2502 \u251c\u2500 zstack_segmentation/ \u2502 \u2502 \u251c\u2500 C3-img1_Z3.tif # Image of z-slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z3__RoiSet.zip # Membrane annotation of slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z8.tif # Image of z-slice 2 \u2502 \u2502 \u251c\u2500 C3-img1_Z8__RoiSet.zip # Membrane annotation of slice 2 \u251c\u2500 img2/ .","title":"Data organisation"},{"location":"cell-membrane-dist/#rna-detection","text":"Detection of RNAs is performed with FISH-quant and detailed here .","title":"RNA detection"},{"location":"cell-membrane-dist/#annotations-of-cell-membrane","text":"In order to be able to compute the enrichment towards cell membrane or nuclear envelope, these membranes have to be annotated in EACH z-slice that should be considered in the analysis. Below we describe a manual annotation with FIJI, in the future automated segmentation results could be considered as well.","title":"Annotations of cell membrane"},{"location":"cell-membrane-dist/#manual-with-fiji","text":"Annotations have to be performed and stored as described below. For each multi-channel image, the annotations are stored in a dedicated sub-folder called zstack_segmentation . Each annotated z-slice has to be saved as an individual image and the file name has to end with the corresponding z-slice i in the format _Zi . For instance, file name ends with img1_ch3_Z3.tif , where 3 is the actual slice number. In FIJI , open the z-stack and go to menu Image > Stack > Stack to images . You can then save each image with the according file-name. Annotations are stored with the name of the corresponding image, with the additional suffix __RoiSet.zip . For the example above, the added suffix would be img1_ch3_Z3__RoiSet.zip . To perform the actual annotation , follow these steps Open FIJI. Open the ROI manager : Analyze > Tools > ROI manager Open/Select the image that you would like to annotate. Select the annotation tool of choice, e.g. freehand or polygon. Outline first structure of interest. When done, press Add(t) in the ROI manager to add outline to the out line manager. Proceed with all other structures. Enabling Show all , will show all defined regions. Save regions by highlighting all regions in the list and pressing on More >> Save ... If only one region is saved, this will created a file with the extension .roi , if multiple regions will be save this will create a .zip file. As a file-name choose the name of the annotated image, followed by the suffix **__RoiSet.zip** . IMPORTANT : these annotations could be used for training of a neural network. If this is intended, then ALL structures, e.g. nuclei, have to be annotated. Unwanted elements, e.g. nuclei touching the cell border, can be removed in a post-processing step.","title":"Manual with FIJI"},{"location":"cell-membrane-dist/#analysis-with-imjoy","text":"The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters.","title":"Analysis with ImJoy"},{"location":"cell-membrane-dist/#analysis-parameters","text":"All options are explained in the Table below. If you change these parameters, the changed values will be saved in the browser and reused the next time you launch ImJoy. Option Type Default Description dZ int 2 Number of z-slices that will be used above and below the currently analyzed slice. Specify this value > 0 if not all z-slices are annotated/ Zmin int 0 Specify at which Z slice analysis should start. Value of 0 means that entire z-stack will be processed. Zmax int 0 As Z min but for maximum Z slice. Channel str 'C3-' Unique identifier for channel containing annotations. Hist [bin] int 20 Bin size for histogram to measure membrane enrichment (in nm). Hist [max] int 100 Maximum value for bins to calculate membrane enrichment. FQ file str FULL path name for FQ file to be analyzed.","title":"Analysis parameters"},{"location":"cell-membrane-dist/#launch-analysis-and-monitor-progress","text":"To analyze a FQ results file, you have to Specify the required parameters in the plugin interface. This includes to copy & paste the FULL name of the FQ results file that should be analyzed. Execute plugin with clicking on the Plugin name CellMembraneDist . The specified file will then be processed and the final distance enrichment histogram displayed in the interface. More plots and result files will be stored as detailed below. Once you start the analysis, ImJoy will show you a progress window with progressbars for the different steps. Once done, it will display the final result in this image.","title":"Launch analysis and monitor progress"},{"location":"cell-membrane-dist/#saved-results","text":"The analysis script will create a new folder with the same name as the selected results file. To allow to redo the analysis with different settings, the plugin will create for each performed analysis a separate sub folder MembDist_yymmdd-hhmm , where is a time-stamp in the format yymmdd-hhmm . This folder contains several files: _DistanceEnrichmentSummary.png : image containing the pooled analysis of all slices. _HistogramPooled.csv : csv file containing the histograms of the RNA-membrane distance pooled from all z-slices. This can be opened with any Spreadsheet application (Excel, LibreOffice, Numbers, ...) and results from different images can then be pooled together. It contains the following data center : center of the bins histRNA_all : raw RNA distance histogram. histRNA_all_norm : normalized RNA histogram (values add to 1). histpix_all_norm : normalized distance histogram of all pixels in the cell. hist_RNA_all_normPix : normalized RNA histogram with the pixel histogram. Z-i.png : results of slice 'i': DataAll.json : json file containing all analysis results including settings. For the example data above, we would obtain the following folder structure (shows only the relevant part for C1-img1 ): . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C1-img1__spots/ \u2502 \u2502 \u251c\u2500 MembDist_181017-1629/ \u2502 \u2502 \u2502 \u251c\u2500 _HistogramPooled.csv \u2502 \u2502 \u2502 \u251c\u2500 _DistanceEnrichmentSummary.png \u2502 \u2502 \u2502 \u251c\u2500 DataAll.json \u2502 \u2502 \u2502 \u251c\u2500 Z-1.png \u2502 \u2502 \u2502 \u251c\u2500 Z-2.png .","title":"Saved results"},{"location":"granules-coloc/","text":"RNA co-localization with cellular granules \u00b6 Workflow to quantify the co-localization between RNA clusters and cellular granules. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation Analysis overview \u00b6 Co-localization between RNA clusters and granules is estimated. RNA detection is performed in FISH-quant. The rest of the analysis in a dedicated ImJoy plugin. RNA clusters are identified by first analyzing smFISH images with FISH-quant and then performing a DB-scan. In order to spatially resolve close RNAs, we use our approach the decompose close RNAs (see section on RNA detection). The RNA detection results are then analyzed with the DB-scan approach. Granules are detected with a blob detection method (https://scikit-image.org/docs/dev/auto_examples/features_detection/plot_blob.html). The user can adjust a threshold for the detection of these blobs. Spatial overlap of clusters and granules is then computed. Data organisation \u00b6 We enforce the following data organisation for this analysis. One folder per multi-channel image ('sample folder'). Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . Channels containing smFISH data are in a sub-separate folder. RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the sample folder. RNA detection is described in more detail here . All other channels (Granules, DAPI) are in the parental sample folder As an example, we have one image img1 with 4 channels. The first two channels contain analysed smFISH data, the third one contains the image of the granules, and the 4th the DAPI image. . \u251c\u2500 img1/ \u2502 \u251c\u2500 C3-img1.tif # Granules image \u2502 \u251c\u2500 C4-img1.tif # DAPI image \u2502 \u251c\u2500 C1/ # CHANNEL 1 \u2502 \u2502 \u251c\u2500 C1-img1.tif # smFISH image \u2502 \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings \u2502 \u2502 \u251c\u2500 results_GMM/ # Spot decomposition results \u2502 \u2502 \u2502 \u251c\u2500 C1-img1_res_GMM.txt \u2502 \u251c\u2500 C2/ # CHANNEL 2 \u2502 \u2502 \u251c\u2500 C2-img1.tif # smFISH image \u2502 \u2502 \u251c\u2500 C2-img1__settings_MATURE.txt # FQ detection settings \u2502 \u2502 \u251c\u2500 results_GMM/ # Spot decomposition results \u2502 \u2502 \u2502 \u251c\u2500 C2-img1_res_GMM.txt \u2502 \u251c\u2500 coloc_granules/ # Analysis results \u2502 \u2502 \u251c\u2500 Channel_C1/ # Results for channel 1 \u2502 \u2502 \u2502 \u251c\u2500 .... \u2502 \u2502 \u251c\u2500 Channel_C2/ # Results for channel 2 \u2502 \u2502 \u2502 \u251c\u2500 .... . RNA detection \u00b6 Please consult the dedicated section here . Analysis in ImJoy \u00b6 The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters and operations that can be performed. Defining a FQ results file \u00b6 In the first field, you can copy&paste the FULL file name of the FQ results file, that you want to analyze. e.g. C1-img1_res_GMM.txt in the example above. Loading data \u00b6 Here the FQ results and all image data are loaded. You have to specify the strings that specify the smFISH image and the granules image. For example, C1 and C3 for the data-set explained above. Once these parameters are specified, you can click on Load data . Here, the specified FQ results file will be used to load all necessary data. Important : make sure that the channel identifiers are correct, if you analyze another FISH channel. Granule detection \u00b6 Here, you can specify a threshold to detect granules. Lower value results in more detections. Click Test granule threshold to apply the currently selected threshold. Note that for testing thresholds the analysis is only performed on a 2D maximum intensity projection (otherwise it takes too long). Once the detection is finished, ImJoy will display a window with the results as shown below. Once you identified a good threshold, you can click on Detect granules in 3D , to perform the analysis on the full 3D image. Note : if you load a new FISH results from the same sample, you don't need to redo the granule detection. The ImJoy plugin stored the last analysis, and it can be reused. In this case, you only have to readjust the DB-scan parameters. DB-scan \u00b6 In order to identify RNA clusers, we anlalyze the 3D RNA positions with a DB-scan. Here you have to set two parameters Here spatial clusters are called based on two criteria (1) maximum allowed distance * eps : maximum allowed distance between spots within a cluster * Min samples : minimum number of spots to be considered as a cluster You can change these values and then perform an analysis by pressing on Perform DB-scan . ImJoy will again show an image with the analysis results. Co-localization analysis \u00b6 Once you are satisfied with the results, you can determine the co-localization between RNA clusters and granules by pressing Analyze co-localzation . Stored results \u00b6 The analysis script will create a folder coloc_granules in the sample folder. Here a separate folder for each analyzed channel is created. A number of images and csv files summarizing the analysis will be stored. iD_blob_detection__ABC-XYZ.png : results of the blob detection. iD : dimension of analyzed image (2D or 3D). ABC : blob detection method. Currently only log is supported. XYZ : detection threshold. COMPARE_granules_clusters.png : results of the coloc analysis. See also image below. 1st first row is is the granule image, 2nd row the FISH image. 2nd column shows detected granules or RNA clusters. 3rd column shows granules/clusters in a color-code to indicate if the co-localize or not. DB_scan_eps-ABC__min-samples-XYZ : results of the DBSCAN. ABC : used eps . XYZ : used minimum number of samples. img_ABC_XyZ.tif : mask or label images of granules or RNA clusters. ABC : granules or RNA clusters XYZ : either label (each object has a unique pixel intensity), or mask (all objects have pixel intensity 1) Intensity_vs_clustering.png . Show the number of RNAs per cluster, or mean granule intensity as a function of being co-localized or not. ABC.csv : properties of granules and clusters such as position, size, or co-localization. These file can be used to summarize multiple images. ABC : granules or RNA clusters VENN_diagram_overlap.png :: VENN diagram showing total number of clusters/granules and how many co-localize.","title":"Granule co-localization"},{"location":"granules-coloc/#rna-co-localization-with-cellular-granules","text":"Workflow to quantify the co-localization between RNA clusters and cellular granules. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation","title":"RNA co-localization with cellular granules"},{"location":"granules-coloc/#analysis-overview","text":"Co-localization between RNA clusters and granules is estimated. RNA detection is performed in FISH-quant. The rest of the analysis in a dedicated ImJoy plugin. RNA clusters are identified by first analyzing smFISH images with FISH-quant and then performing a DB-scan. In order to spatially resolve close RNAs, we use our approach the decompose close RNAs (see section on RNA detection). The RNA detection results are then analyzed with the DB-scan approach. Granules are detected with a blob detection method (https://scikit-image.org/docs/dev/auto_examples/features_detection/plot_blob.html). The user can adjust a threshold for the detection of these blobs. Spatial overlap of clusters and granules is then computed.","title":"Analysis overview"},{"location":"granules-coloc/#data-organisation","text":"We enforce the following data organisation for this analysis. One folder per multi-channel image ('sample folder'). Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . Channels containing smFISH data are in a sub-separate folder. RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the sample folder. RNA detection is described in more detail here . All other channels (Granules, DAPI) are in the parental sample folder As an example, we have one image img1 with 4 channels. The first two channels contain analysed smFISH data, the third one contains the image of the granules, and the 4th the DAPI image. . \u251c\u2500 img1/ \u2502 \u251c\u2500 C3-img1.tif # Granules image \u2502 \u251c\u2500 C4-img1.tif # DAPI image \u2502 \u251c\u2500 C1/ # CHANNEL 1 \u2502 \u2502 \u251c\u2500 C1-img1.tif # smFISH image \u2502 \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings \u2502 \u2502 \u251c\u2500 results_GMM/ # Spot decomposition results \u2502 \u2502 \u2502 \u251c\u2500 C1-img1_res_GMM.txt \u2502 \u251c\u2500 C2/ # CHANNEL 2 \u2502 \u2502 \u251c\u2500 C2-img1.tif # smFISH image \u2502 \u2502 \u251c\u2500 C2-img1__settings_MATURE.txt # FQ detection settings \u2502 \u2502 \u251c\u2500 results_GMM/ # Spot decomposition results \u2502 \u2502 \u2502 \u251c\u2500 C2-img1_res_GMM.txt \u2502 \u251c\u2500 coloc_granules/ # Analysis results \u2502 \u2502 \u251c\u2500 Channel_C1/ # Results for channel 1 \u2502 \u2502 \u2502 \u251c\u2500 .... \u2502 \u2502 \u251c\u2500 Channel_C2/ # Results for channel 2 \u2502 \u2502 \u2502 \u251c\u2500 .... .","title":"Data organisation"},{"location":"granules-coloc/#rna-detection","text":"Please consult the dedicated section here .","title":"RNA detection"},{"location":"granules-coloc/#analysis-in-imjoy","text":"The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters and operations that can be performed.","title":"Analysis in ImJoy"},{"location":"granules-coloc/#defining-a-fq-results-file","text":"In the first field, you can copy&paste the FULL file name of the FQ results file, that you want to analyze. e.g. C1-img1_res_GMM.txt in the example above.","title":"Defining a FQ results file"},{"location":"granules-coloc/#loading-data","text":"Here the FQ results and all image data are loaded. You have to specify the strings that specify the smFISH image and the granules image. For example, C1 and C3 for the data-set explained above. Once these parameters are specified, you can click on Load data . Here, the specified FQ results file will be used to load all necessary data. Important : make sure that the channel identifiers are correct, if you analyze another FISH channel.","title":"Loading data"},{"location":"granules-coloc/#granule-detection","text":"Here, you can specify a threshold to detect granules. Lower value results in more detections. Click Test granule threshold to apply the currently selected threshold. Note that for testing thresholds the analysis is only performed on a 2D maximum intensity projection (otherwise it takes too long). Once the detection is finished, ImJoy will display a window with the results as shown below. Once you identified a good threshold, you can click on Detect granules in 3D , to perform the analysis on the full 3D image. Note : if you load a new FISH results from the same sample, you don't need to redo the granule detection. The ImJoy plugin stored the last analysis, and it can be reused. In this case, you only have to readjust the DB-scan parameters.","title":"Granule detection"},{"location":"granules-coloc/#db-scan","text":"In order to identify RNA clusers, we anlalyze the 3D RNA positions with a DB-scan. Here you have to set two parameters Here spatial clusters are called based on two criteria (1) maximum allowed distance * eps : maximum allowed distance between spots within a cluster * Min samples : minimum number of spots to be considered as a cluster You can change these values and then perform an analysis by pressing on Perform DB-scan . ImJoy will again show an image with the analysis results.","title":"DB-scan"},{"location":"granules-coloc/#co-localization-analysis","text":"Once you are satisfied with the results, you can determine the co-localization between RNA clusters and granules by pressing Analyze co-localzation .","title":"Co-localization analysis"},{"location":"granules-coloc/#stored-results","text":"The analysis script will create a folder coloc_granules in the sample folder. Here a separate folder for each analyzed channel is created. A number of images and csv files summarizing the analysis will be stored. iD_blob_detection__ABC-XYZ.png : results of the blob detection. iD : dimension of analyzed image (2D or 3D). ABC : blob detection method. Currently only log is supported. XYZ : detection threshold. COMPARE_granules_clusters.png : results of the coloc analysis. See also image below. 1st first row is is the granule image, 2nd row the FISH image. 2nd column shows detected granules or RNA clusters. 3rd column shows granules/clusters in a color-code to indicate if the co-localize or not. DB_scan_eps-ABC__min-samples-XYZ : results of the DBSCAN. ABC : used eps . XYZ : used minimum number of samples. img_ABC_XyZ.tif : mask or label images of granules or RNA clusters. ABC : granules or RNA clusters XYZ : either label (each object has a unique pixel intensity), or mask (all objects have pixel intensity 1) Intensity_vs_clustering.png . Show the number of RNAs per cluster, or mean granule intensity as a function of being co-localized or not. ABC.csv : properties of granules and clusters such as position, size, or co-localization. These file can be used to summarize multiple images. ABC : granules or RNA clusters VENN_diagram_overlap.png :: VENN diagram showing total number of clusters/granules and how many co-localize.","title":"Stored results"},{"location":"image-processing/","text":"Image processing \u00b6 Below we describe basic image processing operations, which are used in several workflows. Multi-channel conversion \u00b6 All workflows require that each channel is stored as a separate z-stack. If images are stored as multi-channel z-stacks, they should be split in individual channels. This can usually be performed directly in the image acquisition software, or also with the freely available software FIJI as described below. Open image stack in FIJI, e.g. your .dv , .lif , or .tif images Split channels (FQ only supports mono-channel input images) a. From menu: Image > Color > Split channels a. Save each channels with a unique channel identifier, e.g. with a prefix CH1_ or DAPI_ . Depending on the particular workflow, images belonging you might need to store images belonging to one field of view in a separate folder.","title":"Image processing"},{"location":"image-processing/#image-processing","text":"Below we describe basic image processing operations, which are used in several workflows.","title":"Image processing"},{"location":"image-processing/#multi-channel-conversion","text":"All workflows require that each channel is stored as a separate z-stack. If images are stored as multi-channel z-stacks, they should be split in individual channels. This can usually be performed directly in the image acquisition software, or also with the freely available software FIJI as described below. Open image stack in FIJI, e.g. your .dv , .lif , or .tif images Split channels (FQ only supports mono-channel input images) a. From menu: Image > Color > Split channels a. Save each channels with a unique channel identifier, e.g. with a prefix CH1_ or DAPI_ . Depending on the particular workflow, images belonging you might need to store images belonging to one field of view in a separate folder.","title":"Multi-channel conversion"},{"location":"licence/","text":"License \u00b6 MIT License Copyright \u00a9 Florian MUELLER Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"Licence"},{"location":"licence/#license","text":"MIT License Copyright \u00a9 Florian MUELLER Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"License"},{"location":"nuc-envelop-dist/","text":"RNA distance distribution to nuclear envelope \u00b6 Workflow to quantify the distance distribution of RNAs to the cell membrane. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation Analysis overview \u00b6 For each RNA, we determine the closest distance of an RNA to the nuclear envelope. This distance is negative for an RNA inside a nucleus, and positive for an RNA outside of a nucleus. Distances for all RNAs will be summarised in histogram. These counts are then normalised as follows: Normalisation for complete spatial randomness. There is \"more space\" away from a nucleus than close to it. This means that for a randomly distributed RNA it is less likely to be close to a nucleus, then being further away. We consider this by calculating a histogram with the distance of all pixels in the embryo to the nuclei. The RNA counts are then normalised with this pixel histogram. The normalised histogram is then further normalised such that it sums up to 1. Data organisation \u00b6 We enforce a strict data organisation for this analysis. More information about can be found in the dedicated section below. One folder per multi-channel image ('sample folder'). Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the sample folder. RNA detection is described in more detail here . When performing RNA detection with the GMM approach, the GMM results (ending with _res_GMM.txt ) has to be copied in the sample folder. Annotations of nuclear envelope are stored in a dedicated subfolder zstack_segmentation . More information below . The outline of the embryo has to be store as a single FIJI ROI named embryo_contour.roi . As an example, we have one image img1 with 3 channels. The first channels contain analysed smFISH data, the third one contains the cell membrane annotations for two Z slices (slice 3 and 8). . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C2-img2.tif # smFISH image of (channel 2) \u2502 \u251c\u2500 C2-img2__spots.txt # FQ detection results (channel 2) \u2502 \u251c\u2500 C2-img2__settings_MATURE.txt # FQ detection settings (channel 2) \u2502 \u251c\u2500 embryo_contour.roi # Embryo outline \u2502 \u251c\u2500 zstack_segmentation/ \u2502 \u2502 \u251c\u2500 C3-img1_Z3.tif # Image of z-slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z3__RoiSet.zip # Membrane annotation of slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z8.tif # Image of z-slice 2 \u2502 \u2502 \u251c\u2500 C3-img1_Z8__RoiSet.zip # Membrane annotation of slice 2 \u251c\u2500 img2/ . Annotations of nuclear envelope \u00b6 In order to be able to compute the enrichment towards cell membrane or nuclear envelope, these membranes have to be annotated in EACH z-slice that should be considered in the analysis. This annotation can either be done manually, or automatically. If an automated segmentation is performed, make sure that the results are stored as described below for the manual annotation. Manual with FIJI \u00b6 Annotations have to be performed and stored as described below. For each multi-channel image, the annotations are stored in a dedicated sub-folder called zstack_segmentation . Each annotated z-slice has to be saved as an individual image and the file name has to end with the corresponding z-slice i in the format _Zi . For instance, file name ends with img1_ch3_Z3.tif , where 3 is the actual slice number. You can obtain the individual slices with different methods: FIJI . Open the z-stack and go to menu Image > Stack > Stack to images . You can then save each image with the according file-name. Annotations are stored with the name of the corresponding image, with the additional suffix __RoiSet.zip . For the example above, the added suffix would be img1_ch3_Z3__RoiSet.zip . To perform the actual annotation, follow these steps Open FIJI. Open the ROI manager : Analyze > Tools > ROI manager Open/Select the image that you would like to annotate. Select the annotation tool of choice, e.g. freehand or polygon. Outline first structure of interest. When done, press Add(t) in the ROI manager to add outline to the out line manager. Proceed with all other structures. Enabling Show all , will show all defined regions. Save regions by highlighting all regions in the list and pressing on More >> Save ... If only one region is saved, this will created a file with the extension .roi , if multiple regions will be save this will create a .zip file. As a file-name choose the name of the annotated image, followed by the suffix **__RoiSet.zip** . IMPORTANT : these annotations could be used for training of a neural network. If this is intended, then ALL structures, e.g. nuclei, have to be annotated. Unwanted elements, e.g. nuclei touching the cell border, can be removed in a post-processing step. Analysis with ImJoy \u00b6 The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters of the plugins. Analysis parameters \u00b6 If you change these parameters, the changed values will be saved in the browser and reused the next time you launch ImJoy. Option Type Default Description dZ int 0 Number of z-slices that will be used above and below the currently analysed slice. Specify this value > 0 if not all z-slices are annotated/ Zmin int 0 Specify at which Z slice analysis should start. Value of 0 means that entire z-stack will be processed. Zmax int 0 As Z min but for maximum Z slice. Hist [bins] string ... Defines the edges of the bins that will be used. Values are separated by a comma. FQ file str FULL path name for FQ file to be analyzed. Launch analysis and monitor progress \u00b6 To analyse a FQ results file, you have to Specify the required parameters in the plugin interface. This includes to copy & paste the FULL name of the FQ results file that should be analyzed. This can either be a 'regular' FQ detection, or an analysis with a GMM. Execute plugin with clicking on the Plugin name NuclearEnvelopeEnrichment . This file will then be processed and the final distance enrichment histogram displayed in the interface. More plots and result files will be stored as detailed below. Once you start the analysis, ImJoy will show you a progress window with progress-bars for the different steps. Once done, it will display the final result in this image. Stored results \u00b6 The analysis script will create a new folder with the same name as the selected results file. To allow to redo the analysis with different settings, the plugin will create for each performed analysis a separate sub folder NucEnvelopDist_yymmdd-hhmm , where is a time-stamp in the format yymmdd-hhmm . This folder contains several files: _DistanceEnrichmentSummary.png : image containing the pooled analysis of all slices. _HistogramDistances.csv : csv file containing the histograms of the RNA-membrane distance pooled from all z-slices. This can be opened with any Spreadsheet application (Excel, LibreOffice, Numbers, ...) and results from different images can then be pooled together. It contains the following data center : center of the bins width : width of the bins histRNA_all : raw RNA distance histogram. histPIX_all : normalized RNA histogram (values add to 1). histRNA_norm : normalized RNA histogram with the pixel histogram. DataAll.json : json file containing all analysis results including settings.","title":"Nuclear envelope distance"},{"location":"nuc-envelop-dist/#rna-distance-distribution-to-nuclear-envelope","text":"Workflow to quantify the distance distribution of RNAs to the cell membrane. FISH-quant to detect RNA positions. ImJoy : you can install the plugin from here. ImJoy plugins will be available in the workspace: rna-loc-elegans You will also need the ImJoy plugin engine, please consult the ImJoy documentation","title":"RNA distance distribution to nuclear envelope"},{"location":"nuc-envelop-dist/#analysis-overview","text":"For each RNA, we determine the closest distance of an RNA to the nuclear envelope. This distance is negative for an RNA inside a nucleus, and positive for an RNA outside of a nucleus. Distances for all RNAs will be summarised in histogram. These counts are then normalised as follows: Normalisation for complete spatial randomness. There is \"more space\" away from a nucleus than close to it. This means that for a randomly distributed RNA it is less likely to be close to a nucleus, then being further away. We consider this by calculating a histogram with the distance of all pixels in the embryo to the nuclei. The RNA counts are then normalised with this pixel histogram. The normalised histogram is then further normalised such that it sums up to 1.","title":"Analysis overview"},{"location":"nuc-envelop-dist/#data-organisation","text":"We enforce a strict data organisation for this analysis. More information about can be found in the dedicated section below. One folder per multi-channel image ('sample folder'). Each channel is saved as a separate .tif file containing all z-slices. Information for how to convert stacks can be found here are here . RNA molecules are detected with FISH-quant . Analysis results are also stored directly in the sample folder. RNA detection is described in more detail here . When performing RNA detection with the GMM approach, the GMM results (ending with _res_GMM.txt ) has to be copied in the sample folder. Annotations of nuclear envelope are stored in a dedicated subfolder zstack_segmentation . More information below . The outline of the embryo has to be store as a single FIJI ROI named embryo_contour.roi . As an example, we have one image img1 with 3 channels. The first channels contain analysed smFISH data, the third one contains the cell membrane annotations for two Z slices (slice 3 and 8). . \u251c\u2500 img1/ \u2502 \u251c\u2500 C1-img1.tif # smFISH image (channel 1) \u2502 \u251c\u2500 C1-img1__spots.txt # FQ detection results (channel 1) \u2502 \u251c\u2500 C1-img1__settings_MATURE.txt # FQ detection settings (channel 1) \u2502 \u251c\u2500 C2-img2.tif # smFISH image of (channel 2) \u2502 \u251c\u2500 C2-img2__spots.txt # FQ detection results (channel 2) \u2502 \u251c\u2500 C2-img2__settings_MATURE.txt # FQ detection settings (channel 2) \u2502 \u251c\u2500 embryo_contour.roi # Embryo outline \u2502 \u251c\u2500 zstack_segmentation/ \u2502 \u2502 \u251c\u2500 C3-img1_Z3.tif # Image of z-slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z3__RoiSet.zip # Membrane annotation of slice 1 \u2502 \u2502 \u251c\u2500 C3-img1_Z8.tif # Image of z-slice 2 \u2502 \u2502 \u251c\u2500 C3-img1_Z8__RoiSet.zip # Membrane annotation of slice 2 \u251c\u2500 img2/ .","title":"Data organisation"},{"location":"nuc-envelop-dist/#annotations-of-nuclear-envelope","text":"In order to be able to compute the enrichment towards cell membrane or nuclear envelope, these membranes have to be annotated in EACH z-slice that should be considered in the analysis. This annotation can either be done manually, or automatically. If an automated segmentation is performed, make sure that the results are stored as described below for the manual annotation.","title":"Annotations of nuclear envelope"},{"location":"nuc-envelop-dist/#manual-with-fiji","text":"Annotations have to be performed and stored as described below. For each multi-channel image, the annotations are stored in a dedicated sub-folder called zstack_segmentation . Each annotated z-slice has to be saved as an individual image and the file name has to end with the corresponding z-slice i in the format _Zi . For instance, file name ends with img1_ch3_Z3.tif , where 3 is the actual slice number. You can obtain the individual slices with different methods: FIJI . Open the z-stack and go to menu Image > Stack > Stack to images . You can then save each image with the according file-name. Annotations are stored with the name of the corresponding image, with the additional suffix __RoiSet.zip . For the example above, the added suffix would be img1_ch3_Z3__RoiSet.zip . To perform the actual annotation, follow these steps Open FIJI. Open the ROI manager : Analyze > Tools > ROI manager Open/Select the image that you would like to annotate. Select the annotation tool of choice, e.g. freehand or polygon. Outline first structure of interest. When done, press Add(t) in the ROI manager to add outline to the out line manager. Proceed with all other structures. Enabling Show all , will show all defined regions. Save regions by highlighting all regions in the list and pressing on More >> Save ... If only one region is saved, this will created a file with the extension .roi , if multiple regions will be save this will create a .zip file. As a file-name choose the name of the annotated image, followed by the suffix **__RoiSet.zip** . IMPORTANT : these annotations could be used for training of a neural network. If this is intended, then ALL structures, e.g. nuclei, have to be annotated. Unwanted elements, e.g. nuclei touching the cell border, can be removed in a post-processing step.","title":"Manual with FIJI"},{"location":"nuc-envelop-dist/#analysis-with-imjoy","text":"The entire functionality of the plugin can be controlled within the plugin window. If you expand the plugin, you will see all parameters of the plugins.","title":"Analysis with ImJoy"},{"location":"nuc-envelop-dist/#analysis-parameters","text":"If you change these parameters, the changed values will be saved in the browser and reused the next time you launch ImJoy. Option Type Default Description dZ int 0 Number of z-slices that will be used above and below the currently analysed slice. Specify this value > 0 if not all z-slices are annotated/ Zmin int 0 Specify at which Z slice analysis should start. Value of 0 means that entire z-stack will be processed. Zmax int 0 As Z min but for maximum Z slice. Hist [bins] string ... Defines the edges of the bins that will be used. Values are separated by a comma. FQ file str FULL path name for FQ file to be analyzed.","title":"Analysis parameters"},{"location":"nuc-envelop-dist/#launch-analysis-and-monitor-progress","text":"To analyse a FQ results file, you have to Specify the required parameters in the plugin interface. This includes to copy & paste the FULL name of the FQ results file that should be analyzed. This can either be a 'regular' FQ detection, or an analysis with a GMM. Execute plugin with clicking on the Plugin name NuclearEnvelopeEnrichment . This file will then be processed and the final distance enrichment histogram displayed in the interface. More plots and result files will be stored as detailed below. Once you start the analysis, ImJoy will show you a progress window with progress-bars for the different steps. Once done, it will display the final result in this image.","title":"Launch analysis and monitor progress"},{"location":"nuc-envelop-dist/#stored-results","text":"The analysis script will create a new folder with the same name as the selected results file. To allow to redo the analysis with different settings, the plugin will create for each performed analysis a separate sub folder NucEnvelopDist_yymmdd-hhmm , where is a time-stamp in the format yymmdd-hhmm . This folder contains several files: _DistanceEnrichmentSummary.png : image containing the pooled analysis of all slices. _HistogramDistances.csv : csv file containing the histograms of the RNA-membrane distance pooled from all z-slices. This can be opened with any Spreadsheet application (Excel, LibreOffice, Numbers, ...) and results from different images can then be pooled together. It contains the following data center : center of the bins width : width of the bins histRNA_all : raw RNA distance histogram. histPIX_all : normalized RNA histogram (values add to 1). histRNA_norm : normalized RNA histogram with the pixel histogram. DataAll.json : json file containing all analysis results including settings.","title":"Stored results"},{"location":"rna-detection/","text":"RNA detection with FISH-quant \u00b6 Two options exist, you can either directly analyse the smFISH channels in FQ to detect individual RNAs, or you can use a Matlab script to detect individual RNA molecule and then decomposes RNA aggregates into individual RNAs with a Gaussian Mixture Model (GMM). Detection of individual RNAs \u00b6 Below only a quick summary of the workflow is presented. For more details consult the FQ manual. Open FQ Set analysis folder to folder containing the image that should be analysed: Menu Folder > Set root folder ) Open image that should be analysed. Draw outline of embryo / cells: Open dedicated interface: Button Define outlines Draw a new cell: Button New cell Save outline: Button Quick-save Return to main FQ: Button Finished Filter image (default filter with LoG is usually good). Inspect image. On the right part of the interface select Filtered image , disable outline , and double click on the image. This will show a maximum intensity projection of the filtered image in a separate window. Here, you can change the contrast and zoom. In order to determine an appropriate threshold in the next step, determine a generous range of intensities range corresponding to the individual RNA molecules. Set pre-detection settings . FQ will test how many RNAs are detected with a range of user-defined intensity thresholds (based on the manual inspection of the image from above). Open dedicated interface: Button Detect In the user-dialog change the first two parameter: minimum and maximum threshold to test. We usually use a minimum value that\u2019s somewhat lower than the lowest RNAs to also consider intensity value corresponding to background. FQ will calculate the number of detected RNAs for a range of values in this interval. Depending on the size of the image, this can take a little while. Once done, a plot with the number of detected RNAs as a function of the different thresholds is shown. If the specified range is not appropriate, it can be changed in this interface the computation be repeated. Ideally, this curve shows a plateau for a value range corresponding to a good detection threshold. If that\u2019s not the case, a reasonable value corresponding to a visual assessment of what individual RNAs are should be chosen. A pre-detection with a given detection threshold can be perform and the results be inspected in a separate window. One other parameter that could be important to adjust is the cropping region around each RNA that is considered for analysis and fitting. Reducing this size allows sometimes to better detect closely spaced RNAs but at the cost of an imprecision in the fit. For most applications a value of +/- 2 voxels in XY and Z are a good compromise. Once you are satisfied with the settings press on Perform detection for all cells to return the main window. Press button Fit to fit each detected spot with a 3D Gaussian function. [Optional]. You can set threshold values for the different fitting parameters, e.g. remove spots with very small or very large standard deviations. You can now save the detection settings: [FQ] Main > Save > Save detection settings . As a file-name specify FQ__settings_MATURE.txt Depending on which analysis you want to perform, you either save the detection results or only the specified cell outline. If you are satisfied with these detection results, you can save them directly: [FQ] Main > Save > Detection spots [All] . If you would like to also analyse RNA aggregates, you can save only the outline: [FQ] Main > Save > Outline of cells . Detection of clustered RNAs \u00b6 Her we use an approach that detects individual RNAs and then decomposes aggregates into individual RNAs (for more information see our Nature Communications paper ). This requires that the detection of individual RNA as described above has been performed. After performing the steps above you will have two text files (1) the cell outline, (2) FQ detection settings. The latter can be for an entire experiment or for individual outline files. Depending on how your data is organised a different workflow below will be adequate Detection settings for individual outline files \u00b6 Here, each outline has it's own settings file. We provide a script on the FQ BitBucket repository to analyse these data (WRAPPER_smFISH__GMM_v1.m) . The scripts requires that images, outlines, and settings are in the same folder. You have to specify a string that identifies outline files, and a string that identifies the settings files. Importantly, replacing one string by the other should then yield the respective other files. The script will then loop over all outlines, and process them with the GMM approach Results will stored in a newly created folder with the same name as the outline file. Here two subfolders are created, results_GMM contains the RNA detection with the GMM (to decompose foci into individual RNAs). The most important files are the text files ending with _res_GMM.txt containing the RNA detection results, which will be used to perform the co-localisation. The folder further contains a subfolder #plots with a PDF showing the results of the GMM detection. Individual RNAs are shown in green, decomposed foci with a red number indicating how many RNAs were estimated to be in each foci. results_noGMM contains the RNA detection results without the GMM. In the example below, the strings would be outlines.txt for outlines, and settings_MATURE.txt for the settings. It also shows the newly created folder, containing the GMM results. . \u251c\u2500 fish_data/ \u2502 \u251c\u2500 exp1_ch1_pos01.tif # smFISH image \u2502 \u251c\u2500 exp1_ch1_pos01__outlines.txt # FQ outlines results \u2502 \u251c\u2500 exp1_ch1_pos01__settings_MATURE.txt # FQ detection settings \u2502 \u251c\u2500 exp1_ch1_pos01__spots.txt # FQ spot detection \u2502 \u251c\u2500 exp1_ch1_pos01__outlines/ \u2502 \u251c\u2500 exp1_ch1_pos01__outlines/ \u2502 \u251c\u2500 results_GMM \u2502 \u251c\u2500 exp1_ch1_pos01_res_GMM.txt \u2502 \u251c\u2500 ... .","title":"RNA detection"},{"location":"rna-detection/#rna-detection-with-fish-quant","text":"Two options exist, you can either directly analyse the smFISH channels in FQ to detect individual RNAs, or you can use a Matlab script to detect individual RNA molecule and then decomposes RNA aggregates into individual RNAs with a Gaussian Mixture Model (GMM).","title":"RNA detection with FISH-quant"},{"location":"rna-detection/#detection-of-individual-rnas","text":"Below only a quick summary of the workflow is presented. For more details consult the FQ manual. Open FQ Set analysis folder to folder containing the image that should be analysed: Menu Folder > Set root folder ) Open image that should be analysed. Draw outline of embryo / cells: Open dedicated interface: Button Define outlines Draw a new cell: Button New cell Save outline: Button Quick-save Return to main FQ: Button Finished Filter image (default filter with LoG is usually good). Inspect image. On the right part of the interface select Filtered image , disable outline , and double click on the image. This will show a maximum intensity projection of the filtered image in a separate window. Here, you can change the contrast and zoom. In order to determine an appropriate threshold in the next step, determine a generous range of intensities range corresponding to the individual RNA molecules. Set pre-detection settings . FQ will test how many RNAs are detected with a range of user-defined intensity thresholds (based on the manual inspection of the image from above). Open dedicated interface: Button Detect In the user-dialog change the first two parameter: minimum and maximum threshold to test. We usually use a minimum value that\u2019s somewhat lower than the lowest RNAs to also consider intensity value corresponding to background. FQ will calculate the number of detected RNAs for a range of values in this interval. Depending on the size of the image, this can take a little while. Once done, a plot with the number of detected RNAs as a function of the different thresholds is shown. If the specified range is not appropriate, it can be changed in this interface the computation be repeated. Ideally, this curve shows a plateau for a value range corresponding to a good detection threshold. If that\u2019s not the case, a reasonable value corresponding to a visual assessment of what individual RNAs are should be chosen. A pre-detection with a given detection threshold can be perform and the results be inspected in a separate window. One other parameter that could be important to adjust is the cropping region around each RNA that is considered for analysis and fitting. Reducing this size allows sometimes to better detect closely spaced RNAs but at the cost of an imprecision in the fit. For most applications a value of +/- 2 voxels in XY and Z are a good compromise. Once you are satisfied with the settings press on Perform detection for all cells to return the main window. Press button Fit to fit each detected spot with a 3D Gaussian function. [Optional]. You can set threshold values for the different fitting parameters, e.g. remove spots with very small or very large standard deviations. You can now save the detection settings: [FQ] Main > Save > Save detection settings . As a file-name specify FQ__settings_MATURE.txt Depending on which analysis you want to perform, you either save the detection results or only the specified cell outline. If you are satisfied with these detection results, you can save them directly: [FQ] Main > Save > Detection spots [All] . If you would like to also analyse RNA aggregates, you can save only the outline: [FQ] Main > Save > Outline of cells .","title":"Detection of individual RNAs"},{"location":"rna-detection/#detection-of-clustered-rnas","text":"Her we use an approach that detects individual RNAs and then decomposes aggregates into individual RNAs (for more information see our Nature Communications paper ). This requires that the detection of individual RNA as described above has been performed. After performing the steps above you will have two text files (1) the cell outline, (2) FQ detection settings. The latter can be for an entire experiment or for individual outline files. Depending on how your data is organised a different workflow below will be adequate","title":"Detection of clustered RNAs"},{"location":"rna-detection/#detection-settings-for-individual-outline-files","text":"Here, each outline has it's own settings file. We provide a script on the FQ BitBucket repository to analyse these data (WRAPPER_smFISH__GMM_v1.m) . The scripts requires that images, outlines, and settings are in the same folder. You have to specify a string that identifies outline files, and a string that identifies the settings files. Importantly, replacing one string by the other should then yield the respective other files. The script will then loop over all outlines, and process them with the GMM approach Results will stored in a newly created folder with the same name as the outline file. Here two subfolders are created, results_GMM contains the RNA detection with the GMM (to decompose foci into individual RNAs). The most important files are the text files ending with _res_GMM.txt containing the RNA detection results, which will be used to perform the co-localisation. The folder further contains a subfolder #plots with a PDF showing the results of the GMM detection. Individual RNAs are shown in green, decomposed foci with a red number indicating how many RNAs were estimated to be in each foci. results_noGMM contains the RNA detection results without the GMM. In the example below, the strings would be outlines.txt for outlines, and settings_MATURE.txt for the settings. It also shows the newly created folder, containing the GMM results. . \u251c\u2500 fish_data/ \u2502 \u251c\u2500 exp1_ch1_pos01.tif # smFISH image \u2502 \u251c\u2500 exp1_ch1_pos01__outlines.txt # FQ outlines results \u2502 \u251c\u2500 exp1_ch1_pos01__settings_MATURE.txt # FQ detection settings \u2502 \u251c\u2500 exp1_ch1_pos01__spots.txt # FQ spot detection \u2502 \u251c\u2500 exp1_ch1_pos01__outlines/ \u2502 \u251c\u2500 exp1_ch1_pos01__outlines/ \u2502 \u251c\u2500 results_GMM \u2502 \u251c\u2500 exp1_ch1_pos01_res_GMM.txt \u2502 \u251c\u2500 ... .","title":"Detection settings for individual outline files"},{"location":"tools-fishquant/","text":"FISH-quant: RNA detection \u00b6 FISH-quant is a Matlab toolbox to localize RNAs in 3D from smFISH images. FISH-quant is often used to perform the RNA detection. Eventually, we would like to implement the main FISH-quant features in ImJoy.","title":"FISH-quant"},{"location":"tools-fishquant/#fish-quant-rna-detection","text":"FISH-quant is a Matlab toolbox to localize RNAs in 3D from smFISH images. FISH-quant is often used to perform the RNA detection. Eventually, we would like to implement the main FISH-quant features in ImJoy.","title":"FISH-quant: RNA detection"},{"location":"tools-imjoy/","text":"ImJoy \u00b6 ImJoy is image processing platform with an easy to use interface running in your browser. While ImJoy is a browser app, NO user data will be transferred over the internet. For best stability, we recommend using Chrome to run the ImJoy app. Some of its main features are: Specific functionality is provided by plugins , which can be installed with simple links. Available plugins are listed in the plugin list on the left part of the interface. Depending on the implementation plugins are either executed directly by pressing on their name, or a simple interface can be displayed when pressing on the arrow down symbol. ImJoy can have several workspaces . Each workspace can contain multiple plugins and is often dedicated to a specific data processing task. Workspaces can be selected from little puzzle symbol in the upper left part of the interface. Basic usage \u00b6 Installing plugins \u00b6 We provide links to install ImJoy plugins for the different workflows. These installation links also specify in which ImJoy workspaces the plugin will be installed If you press on the installation link, the ImJoy web app will open and display a dialog asking if you want to install the specified plugin. To confirm, press the install button. Opening a workspace \u00b6 Once a plugin is installed, ImJoy remembers the workspaces and plugins it contains. If you want to redo an analysis, you simply have to open the ImJoy app and select the appropriate ( rna-loc-elegans for this package): Running Python plugins \u00b6 Most of the provided plugins use Python for data processing. To use these plugins, you have to connect ImJoy to a Plugin engine. For this repository, we use Jupyter notebooks as and engine, which can be installed via Miniconda (see section about Python Installation below ). Connect Jupyter engine \u00b6 Once installed Jupyter is installed, you can start a Jupyter Notebook in the anaconda terminal, to which ImJoy can connect. Please note that this engine runs on your local machine, so no data-transfer over the internet is taking place. In order to connect a Jupyter engine, you need to specify its url that also contains a token (a passphrase). If you launch a Jupyter notebook for the first time, you have to provide this URL to ImJoy (indicated below with First time only ). After this, ImJoy will remember it. Launch a Jupyter Engine for ImJoy : Start an anaconda terminal . Activate the environment : conda activate rna-loc-elegans Start Jupyter engine : imjoy --jupyter First time only : copy the provided URL including the token, e.g. http://127.0.0.1:8888/?token=8b4885e452db1af7cd7b3cfa6c62036cbae46995e473c25e Connect ImJoy to Jupyter Engine : In the ImJoy app, press on the rocket symbol in the upper right corner. First time only : select Add Jupyter-Engine , paste the URL from the step above, and you can give a new name to the engine Subsequent use : press on the pre-defined plugin engine to connect to it (of course you have to launch it first). If this is the only engine, plugins will be automatically connected . You can verify this, by clicking on the puzzle symbol next to the plugin name. Depending on the plugin, installation might take a while, during this period the plugin name will be in red. If yoy have multiple engines, you have to choose on which engine the plugin should be running (more details below ). Managing plugin engines \u00b6 ImJoy remembers the plugin engines it connected to (including the token). You can obtain the list of all registered engines by pressing on the rocket symbol. Connected engines will be shown with their name in black, and a red cross next to the name. Pressing the cross will disconnect ImJoy from the engine, but it will remain in the list. Known engines (but not connected) will be shown with their name in gray, with a little trash symbol next to them. Pressing on the trash symbol will remove the engine. Installing Python for ImJoy \u00b6 We recommend installing an Miniconda distribution of Python : choose Python 3.7 and your operating system. You can then use the annoconda prompt to excecute the different commands listed below. We further recommend creating a dedicated environment to run code in this analysis package. This guarantess that only necessary code is installed. To create an environment called rna-loc-elegans , open an anaconda prompt and type (Confirm with y when asked if you want to proceed ( Proceed ([y]/n)? ): conda create --name rna-loc-elegans python=3.7 Activate the environment : conda activate rna-loc-elegans Install code Jupyter optimized for ImJoy : pip install -U imjoy Trouble-shooting \u00b6 Plugin running on wrong engine \u00b6 You have several options Disconnect or delete the engine the plugin is connecting to (see ) here ). In the plugin menu (clicking on the little puzzle symbol left of the plugin name), select the appropriate engine. Remove conda environment \u00b6 At one point, your conda environment might get corrupted. You can easily remove it, and create a new one Open anaconda terminal Activate base environment : conda activate base Remove rna-loc-elegans environment : conda env remove --name rna-loc-elegans Reporting bugs \u00b6 Detailed installation logs are provided in the console of the browser. Information in this log, can facilitate the correction of encountered bugs. When reporting problems with this package, please provide the log copied to text file. To acces the console log in Chrome : In the ImJoy app mouse-right-click. Select Inspect . This will open a new interface on the right size of your browser windows. Select the panel Console and copy the entire content, and paste it to a file. Specify your own Jupyter token \u00b6 You can specify your own token yourtoken imjoy --jupyter --token yourtoken When launched like this, you will not get the full Jupyter URL in the terminal, but http://localhost:8888/?token=... . When copying this link to the ImJoy app for the first time you have to replace the ... by the token you actually specified. The next time you start jupyter with imjoy --jupyter your custom token will be used","title":"ImJoy"},{"location":"tools-imjoy/#imjoy","text":"ImJoy is image processing platform with an easy to use interface running in your browser. While ImJoy is a browser app, NO user data will be transferred over the internet. For best stability, we recommend using Chrome to run the ImJoy app. Some of its main features are: Specific functionality is provided by plugins , which can be installed with simple links. Available plugins are listed in the plugin list on the left part of the interface. Depending on the implementation plugins are either executed directly by pressing on their name, or a simple interface can be displayed when pressing on the arrow down symbol. ImJoy can have several workspaces . Each workspace can contain multiple plugins and is often dedicated to a specific data processing task. Workspaces can be selected from little puzzle symbol in the upper left part of the interface.","title":"ImJoy"},{"location":"tools-imjoy/#basic-usage","text":"","title":"Basic usage"},{"location":"tools-imjoy/#installing-plugins","text":"We provide links to install ImJoy plugins for the different workflows. These installation links also specify in which ImJoy workspaces the plugin will be installed If you press on the installation link, the ImJoy web app will open and display a dialog asking if you want to install the specified plugin. To confirm, press the install button.","title":"Installing plugins"},{"location":"tools-imjoy/#opening-a-workspace","text":"Once a plugin is installed, ImJoy remembers the workspaces and plugins it contains. If you want to redo an analysis, you simply have to open the ImJoy app and select the appropriate ( rna-loc-elegans for this package):","title":"Opening a workspace"},{"location":"tools-imjoy/#running-python-plugins","text":"Most of the provided plugins use Python for data processing. To use these plugins, you have to connect ImJoy to a Plugin engine. For this repository, we use Jupyter notebooks as and engine, which can be installed via Miniconda (see section about Python Installation below ).","title":"Running Python plugins"},{"location":"tools-imjoy/#connect-jupyter-engine","text":"Once installed Jupyter is installed, you can start a Jupyter Notebook in the anaconda terminal, to which ImJoy can connect. Please note that this engine runs on your local machine, so no data-transfer over the internet is taking place. In order to connect a Jupyter engine, you need to specify its url that also contains a token (a passphrase). If you launch a Jupyter notebook for the first time, you have to provide this URL to ImJoy (indicated below with First time only ). After this, ImJoy will remember it. Launch a Jupyter Engine for ImJoy : Start an anaconda terminal . Activate the environment : conda activate rna-loc-elegans Start Jupyter engine : imjoy --jupyter First time only : copy the provided URL including the token, e.g. http://127.0.0.1:8888/?token=8b4885e452db1af7cd7b3cfa6c62036cbae46995e473c25e Connect ImJoy to Jupyter Engine : In the ImJoy app, press on the rocket symbol in the upper right corner. First time only : select Add Jupyter-Engine , paste the URL from the step above, and you can give a new name to the engine Subsequent use : press on the pre-defined plugin engine to connect to it (of course you have to launch it first). If this is the only engine, plugins will be automatically connected . You can verify this, by clicking on the puzzle symbol next to the plugin name. Depending on the plugin, installation might take a while, during this period the plugin name will be in red. If yoy have multiple engines, you have to choose on which engine the plugin should be running (more details below ).","title":"Connect Jupyter engine"},{"location":"tools-imjoy/#managing-plugin-engines","text":"ImJoy remembers the plugin engines it connected to (including the token). You can obtain the list of all registered engines by pressing on the rocket symbol. Connected engines will be shown with their name in black, and a red cross next to the name. Pressing the cross will disconnect ImJoy from the engine, but it will remain in the list. Known engines (but not connected) will be shown with their name in gray, with a little trash symbol next to them. Pressing on the trash symbol will remove the engine.","title":"Managing plugin engines"},{"location":"tools-imjoy/#installing-python-for-imjoy","text":"We recommend installing an Miniconda distribution of Python : choose Python 3.7 and your operating system. You can then use the annoconda prompt to excecute the different commands listed below. We further recommend creating a dedicated environment to run code in this analysis package. This guarantess that only necessary code is installed. To create an environment called rna-loc-elegans , open an anaconda prompt and type (Confirm with y when asked if you want to proceed ( Proceed ([y]/n)? ): conda create --name rna-loc-elegans python=3.7 Activate the environment : conda activate rna-loc-elegans Install code Jupyter optimized for ImJoy : pip install -U imjoy","title":"Installing Python for ImJoy"},{"location":"tools-imjoy/#trouble-shooting","text":"","title":"Trouble-shooting"},{"location":"tools-imjoy/#plugin-running-on-wrong-engine","text":"You have several options Disconnect or delete the engine the plugin is connecting to (see ) here ). In the plugin menu (clicking on the little puzzle symbol left of the plugin name), select the appropriate engine.","title":"Plugin running on wrong engine"},{"location":"tools-imjoy/#remove-conda-environment","text":"At one point, your conda environment might get corrupted. You can easily remove it, and create a new one Open anaconda terminal Activate base environment : conda activate base Remove rna-loc-elegans environment : conda env remove --name rna-loc-elegans","title":"Remove conda environment"},{"location":"tools-imjoy/#reporting-bugs","text":"Detailed installation logs are provided in the console of the browser. Information in this log, can facilitate the correction of encountered bugs. When reporting problems with this package, please provide the log copied to text file. To acces the console log in Chrome : In the ImJoy app mouse-right-click. Select Inspect . This will open a new interface on the right size of your browser windows. Select the panel Console and copy the entire content, and paste it to a file.","title":"Reporting bugs"},{"location":"tools-imjoy/#specify-your-own-jupyter-token","text":"You can specify your own token yourtoken imjoy --jupyter --token yourtoken When launched like this, you will not get the full Jupyter URL in the terminal, but http://localhost:8888/?token=... . When copying this link to the ImJoy app for the first time you have to replace the ... by the token you actually specified. The next time you start jupyter with imjoy --jupyter your custom token will be used","title":"Specify your own Jupyter token"}]}